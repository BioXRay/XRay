##https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&mid=2247487965&idx=1&sn=60a7f4b692da9892f61639d06e961a80&scene=21#wechat_redirect
install.packages("pdftools")
library(pdftools)
pdf_info<-pdf_text("SuppTable.pdf")
gsub("\r",'',strsplit(pdf_info[1],split='\n')[[1]])
unlist(strsplit(pdf_info[1],split='\r\n'))
GENE_INFO<-unlist(strsplit(pdf_info[1],split='\r\n'))
data.frame(GENE_INFO)
strsplit(data.frame(GENE_INFO)[1,],split=' ')
strsplit(data.frame(GENE_INFO,stringsAsFactors = FALSE)[1,],split=" ")
GENE_TMP<-unlist(lapply(1:17,function(i){trimws(strsplit(pdf_info[i],split="\r\n")[[1]])}))
tmp<-unlist(strsplit(head(GENE_TMP[-c(1:2)])[1],' '))
paste(tmp[-1],collapse = " ")
trimws(paste(tmp[-1],collapse = " "))
gene_data<-do.call(rbind,lapply(strsplit(head(GENE_TMP[-c(1:2)]),' '),function(x){
x<-x[-length(x)]
gene_name<-x[1]
cell_type<-trimws(paste(x[-1],collapse = " "))
return(c(gene_name,cell_type))
}))
gene_data<-do.call(rbind,lapply(strsplit(GENE_TMP[-c(1:2)],' '),function(x){
x<-x[-length(x)]
gene_name<-x[1]
cell_type<-trimws(paste(x[-1],collapse = " "))
return(c(gene_name,cell_type))
}))
split(gene_data[,1],gene_data[,2])
length(split(gene_data[,1],gene_data[,2]))
immune_list<-split(gene_data[,1],gene_data[,2])

